"use strict";(self["webpackChunkcms"]=self["webpackChunkcms"]||[]).push([[2],{9002:function(e,t,a){a.r(t),a.d(t,{default:function(){return N}});var i=a(9199);const l={class:"row pl-3 pr-3"},o={class:"col-12 col-md-6 pt-1"},s={class:"col-12 col-md-6 pt-1"},n=(0,i._)("div",{align:"center",class:"mt-2 mb-2"},"You want to remove this record ?",-1),r={class:"dialog-footer",slot:"footer"},d=(0,i.Uk)("Cancel"),u=(0,i.Uk)("Yes");function c(e,t,a,c,p,h){const m=(0,i.up)("moduleForm"),g=(0,i.up)("el-dialog"),f=(0,i.up)("dg-text-field"),v=(0,i.up)("pagination"),y=(0,i.up)("app-ag-grid"),w=(0,i.up)("el-button"),C=(0,i.up)("module-list-layout");return p.amReady?((0,i.wg)(),(0,i.j4)(C,{key:0,createAction:h.createAction,module:p.module,class:"p-2"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{visible:p.dialogVisible,title:"",top:"5vh",width:"75%"},{default:(0,i.w5)((()=>[p.dialogVisible?((0,i.wg)(),(0,i.j4)(m,{key:0,autoBind:!1,bindingForView:!0,dataToBind:p.dataToBind,"edit-mode":p.editMode,formHeader:!0,formTitle:(p.editMode?"Update ":"Create ")+p.module.info.caption,moduleDeleteAction:h.moduleFormDeleteAction,"on-create-callback":h.afterCreate,"on-edit-callback":h.afterEdit},null,8,["dataToBind","edit-mode","formTitle","moduleDeleteAction","on-create-callback","on-edit-callback"])):(0,i.kq)("",!0)])),_:1},8,["visible"]),(0,i._)("div",l,[(0,i._)("div",o,[(0,i.Wm)(f,{field_span:19,label_span:24,liveUpdate:!0,onAmUpdated:h.userSearchUpdated,field_mark:"",placeholder:"search here"},null,8,["onAmUpdated"])]),(0,i._)("div",s,[(0,i.Wm)(v,{currentPage:p.currentPage,"margin-pages":2,navigateHandler:h.navigateToPage,"page-count":h.getPagesCount(),"page-range":4,paginateClass:""},null,8,["currentPage","navigateHandler","page-count"])])]),(0,i.Wm)(y,{agGrid:p.agGrid},null,8,["agGrid"]),(0,i.Wm)(g,{visible:p.deleteDialogVisible,center:"",title:"Warning",width:"420px"},{default:(0,i.w5)((()=>[n,(0,i._)("span",r,[(0,i.Wm)(w,{onClick:t[0]||(t[0]=e=>p.deleteDialogVisible=!1),size:"small"},{default:(0,i.w5)((()=>[d])),_:1}),(0,i.Wm)(w,{onClick:h.removeActionApi,size:"small",type:"danger"},{default:(0,i.w5)((()=>[u])),_:1},8,["onClick"])])])),_:1},8,["visible"])])),_:1},8,["createAction","module"])):(0,i.kq)("",!0)}const p=(0,i._)("i",{class:"el-icon-edit-outline"},null,-1),h=(0,i._)("i",{class:"el-icon-delete"},null,-1);function m(e,t){const a=(0,i.up)("el-button"),l=(0,i.up)("el-dropdown-item"),o=(0,i.up)("el-dropdown-menu"),s=(0,i.up)("el-dropdown");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(s,{trigger:"click",onCommand:t[0]||(t[0]=t=>e.params.props.actionsHandler(t,e.params))},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{icon:"el-icon-more",type:"plain",size:"mini"}),(0,i.Wm)(o,{slot:"dropdown"},{default:(0,i.w5)((()=>[(0,i.Wm)(l,{command:"editAction"},{default:(0,i.w5)((()=>[p,(0,i.Uk)(" "+(0,i.zw)(e.$ml.get("edit")),1)])),_:1}),(0,i.Wm)(l,{command:"removeAction"},{default:(0,i.w5)((()=>[h,(0,i.Uk)(" "+(0,i.zw)(e.$ml.get("remove")),1)])),_:1})])),_:1})])),_:1})])}var g=a(89);const f={},v=(0,g.Z)(f,[["render",m]]);var y=v;function w(e,t,a,l,o,s){const n=(0,i.up)("el-switch");return(0,i.wg)(),(0,i.j4)(n,{onChange:s.change,modelValue:o.toggleState,"onUpdate:modelValue":t[0]||(t[0]=e=>o.toggleState=e)},null,8,["onChange","modelValue"])}var C={data(){return{toggleState:!1}},beforeMount(){this.toggleState=1===this.params.data.used_by_root},methods:{change(e){let t={value:e,module_id:this.params.data.id};this.params.props.actionsHandler("setUsedByRoot",t)}}};const b=(0,g.Z)(C,[["render",w]]);var k=b,T=a(5677);const V={key:0},_={class:"copy-to-target"};function x(e,t,a,l,o,s){const n=(0,i.up)("el-input"),r=(0,i.up)("el-button");return(0,i.wg)(),(0,i.iD)("div",null,[o.editMode?((0,i.wg)(),(0,i.iD)("div",{key:1,class:"editing-mode-container",style:(0,i.j5)(o.editContainerStyle)},[(0,i._)("i",{class:"el-icon-circle-close text-danger",style:{"margin-right":"5px"},onClick:t[2]||(t[2]=(...e)=>s.returnToOriginal&&s.returnToOriginal(...e))}),(0,i.Wm)(n,{ref:"input",onInput:s.change,placeholder:"",size:"mini",modelValue:o.cellValue,"onUpdate:modelValue":t[3]||(t[3]=e=>o.cellValue=e),style:(0,i.j5)("width:"+o.inputWidth)},null,8,["onInput","modelValue","style"]),o.saveIsActive?((0,i.wg)(),(0,i.j4)(r,{key:0,onClick:s.saveNewValue,class:"ml-2",type:"success",icon:"el-icon-check",circle:"",size:"mini"},null,8,["onClick"])):(0,i.kq)("",!0)],4)):((0,i.wg)(),(0,i.iD)("span",V,[(0,i._)("i",{class:"el-icon-copy-document text-info mr-2",style:{cursor:"pointer"},onClick:t[0]||(t[0]=(...e)=>s.copyToClipBoard&&s.copyToClipBoard(...e))}),(0,i._)("i",{class:"el-icon-edit text-info mr-2",style:{cursor:"pointer"},onClick:t[1]||(t[1]=(...e)=>s.fucusIn&&s.fucusIn(...e))}),(0,i._)("span",_,(0,i.zw)(o.cellValue),1)]))])}var A={data(){return{editMode:!1,cellValue:"",originalValue:0,saveIsActive:!1,inputWidth:"120px",editContainerStyle:""}},beforeMount(){this.params.props.editContainerStyle&&(this.editContainerStyle=this.params.props.editContainerStyle),this.cellValue=this.params.data[this.params.props.valuePropertyName],this.originalValue=this.params.data[this.params.props.valuePropertyName],this.params.props.inputWidth&&(this.inputWidth=this.params.props.inputWidth)},methods:{copyToClipBoard(){let e=this.$el.getElementsByClassName("copy-to-target")[0];const t=document.createElement("textarea");t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",t.value=e.innerText,document.body.appendChild(t),t.select(),document.execCommand("copy")&&this.$notify({title:"Copied to clipboard",type:"success",showClose:!1,duration:1e3}),document.body.removeChild(t)},fucusIn(){this.editMode=!0,i["default"].nextTick((()=>{this.$refs["input"].focus()}))},fucusout(){this.returnToOriginal()},returnToOriginal(){this.editMode=!1,this.cellValue=this.originalValue,this.saveIsActive=!1},saveNewValue(){this.params.props.saveAction(this.params,this.cellValue,(()=>{this.editMode=!1,this.originalValue=this.cellValue,this.saveIsActive=!1}),this.params.props.valuePropertyName)},change(e){this.originalValue!==this.cellValue?this.saveIsActive=!0:this.saveIsActive=!1}}};const D=(0,g.Z)(A,[["render",x],["__scopeId","data-v-0f710232"]]);var P=D,S=a(7139),G={components:{pagination:()=>a.e(666).then(a.bind(a,4666)),moduleForm:()=>a.e(606).then(a.bind(a,4606)),moduleListLayout:()=>a.e(60).then(a.bind(a,5060))},data(){return{deleteDialogVisible:!1,targetParams:null,userSearch:"",userSearchTimeOut:null,amReady:!1,module:{...T["default"]},currentPage:1,pageChunkSize:12,pageCount:1,editMode:!1,dialogVisible:!1,recordsCounter:0,dataToBind:null,rowToEdit:null,agGrid:{pagination:!1,enableRtl:"rtl"==$langConfig.dir,agGridStyle:"width: 100%; height: 650px; padding: 0",agGridClass:"ag-theme-material",gridOptions:{suppressCellSelection:!0,onGridReady:function(e){e.api.sizeColumnsToFit()}},columnDefs:[{field:"namespace",headerName:"Namespace",headerClass:$langConfig.lang+"-lang-text text-capitalize",autoHeight:!0,suppressKeyboardEvent:e=>!0,cellRendererFramework:i["default"].extend(P),cellRendererParams:{props:{inputWidth:"180px",valuePropertyName:"namespace",saveAction:this.updateField,editContainerStyle:"top: 0px;"}}},{field:"name",headerName:"Name",headerClass:$langConfig.lang+"-lang-text"},{field:"group_name",headerName:"Group Name",headerClass:$langConfig.lang+"-lang-text"},{field:"caption",headerName:"Caption",headerClass:$langConfig.lang+"-lang-text text-capitalize"},{width:100,field:"used_by_root",headerName:"Used by Root",headerClass:$langConfig.lang+"-lang-text text-capitalize",autoHeight:!0,cellRendererFramework:i["default"].extend(k),cellRendererParams:{props:{actionsHandler:this.actionsHandler}}},{width:80,headerName:this.$ml.get("actions"),headerClass:$langConfig.lang+"-lang-text text-capitalize",cellRendererFramework:i["default"].extend(y),cellRendererParams:{props:{actionsHandler:this.actionsHandler}}}],rowData:[]}}},beforeMount(){this.currentPage=parseInt(this.$route.params.listPage),this.getEntityListData(this.currentPage)},methods:{updateField(e,t,a,i){let l={};l[i]=t;let o={id:e.data.id,data:l};this.updateModule(o).then((e=>{a()}))},setUsedByRoot(e){let t={id:e.module_id,data:{used_by_root:e.value?1:0}};this.updateModule(t)},getEntityListData(e){this.getEntityList({page:e,search:this.userSearch}).then((e=>{this.buildAgGridData(e)})),this.currentPage=e},buildAgGridData(e){this.agGrid.rowData=e.rows,this.recordsCounter=e.count,this.amReady=!0},userSearchUpdated(e){let t=e.field.field_value;this.userSearch=t,clearTimeout(this.userSearchTimeOut),this.userSearchTimeOut=setTimeout((()=>{this.getEntityListData(1)}),200)},...(0,S.nv)(T["default"].info.fullName+"-api",{getEntityList:"list",updateModule:"update"}),scrollToTop(){document.body.scrollTop=0,document.getElementById("content-main-container").scrollTop=0},getPagesCount(){return Math.ceil(this.recordsCounter/this.pageChunkSize)},navigateToPage(e){$router.push({name:this.module.info.routeName+"->list->page",params:{listPage:e}})},refreshGrid(){this.agGrid.gridOptions.api.setRowData(this.agGrid.rowData)},afterEdit(e,t=!1,a=!0){t?this.agGrid.rowData[this.rowToEdit][t]=e:this.agGrid.rowData[this.rowToEdit]=e,a&&(this.dialogVisible=!1),this.refreshGrid()},moduleFormDeleteAction(){this.removeAction({data:this.dataToBind,rowIndex:this.rowToEdit}),this.dialogVisible=!1},afterCreate(e){this.agGrid.rowData.push(e),this.dialogVisible=!1,this.refreshGrid()},createAction(e){this.dialogVisible=!0,this.editMode=!1,this.dataToBind=null,this.rowToEdit=null},editAction(e){this.dialogVisible=!0,this.editMode=!0,this.dataToBind=e.data,this.rowToEdit=e.rowIndex},removeAction(e){this.targetParams=e,this.deleteDialogVisible=!0},removeActionApi(){let e=this.targetParams;this.deleteDialogVisible=!1,this.$store.dispatch(this.module.info.fullName+"-api/remove",{id:e.data.id}).then((t=>{this.agGrid.rowData.splice(e.rowIndex,1),this.refreshGrid(),this.recordsCounter-=1,$notify.view({type:"success",title:this.$ml.get("deleted")})}))},actionsHandler(e,t){this[e](t)}}};const W=(0,g.Z)(G,[["render",c]]);var N=W}}]);
//# sourceMappingURL=2.11bc83c1.js.map